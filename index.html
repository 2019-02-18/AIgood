<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ¯ Aè‚¡ç‰›ç†Šé£å‘æ ‡é¢„æµ‹ç³»ç»Ÿ</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        /* ğŸ¨ å…¨å±€æ ·å¼ - ç°ä»£åŒ–è®¾è®¡ */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'SF Pro Display', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
            padding: 20px;
        }
        
        /* ğŸŒŸ ä¸»å®¹å™¨ - ç»ç’ƒæ‹Ÿæ€æ•ˆæœ */
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(20px);
            border-radius: 20px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            padding: 40px;
        }
        
        /* ğŸ“± å“åº”å¼æ ‡é¢˜ */
        .main-title {
            text-align: center;
            color: white;
            font-size: 3rem;
            font-weight: 700;
            margin-bottom: 10px;
            text-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
        }
        
        .subtitle {
            text-align: center;
            color: rgba(255, 255, 255, 0.8);
            font-size: 1.2rem;
            margin-bottom: 40px;
        }
        
        /* ğŸ“Š ç»Ÿè®¡å¡ç‰‡ */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 40px;
        }
        
        .stat-card {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            padding: 25px;
            text-align: center;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
        }
        
        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.15);
        }
        
        .stat-icon {
            font-size: 2.5rem;
            margin-bottom: 15px;
            background: linear-gradient(135deg, #667eea, #764ba2);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        
        .stat-number {
            font-size: 2rem;
            font-weight: 700;
            color: #2c3e50;
            margin-bottom: 5px;
        }
        
        .stat-label {
            color: #666;
            font-size: 1rem;
        }
        
        /* ğŸ“‹ é¢„æµ‹æŠ¥å‘Šåˆ—è¡¨ */
        .reports-section {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 30px;
        }
        
        .section-title {
            font-size: 1.8rem;
            font-weight: 700;
            color: #2c3e50;
            margin-bottom: 25px;
            display: flex;
            align-items: center;
        }
        
        .section-title i {
            margin-right: 15px;
            color: #667eea;
        }
        
        .reports-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
            gap: 20px;
        }
        
        .report-card {
            background: linear-gradient(135deg, #f8f9fa, #e9ecef);
            border-radius: 15px;
            padding: 25px;
            border: 2px solid transparent;
            transition: all 0.3s ease;
            cursor: pointer;
            position: relative;
            overflow: hidden;
        }
        
        .report-card:hover {
            border-color: #667eea;
            transform: translateY(-3px);
            box-shadow: 0 15px 35px rgba(102, 126, 234, 0.2);
        }
        
        .report-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.4), transparent);
            transition: left 0.5s;
        }
        
        .report-card:hover::before {
            left: 100%;
        }
        
        .report-date {
            font-size: 1.3rem;
            font-weight: 700;
            color: #2c3e50;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
        }
        
        .report-date i {
            margin-right: 10px;
            color: #667eea;
        }
        
        .report-status {
            display: inline-block;
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
            margin-bottom: 15px;
        }
        
        .status-latest {
            background: linear-gradient(135deg, #28a745, #20c997);
            color: white;
        }
        
        .status-archive {
            background: linear-gradient(135deg, #6c757d, #495057);
            color: white;
        }
        
        .report-preview {
            color: #666;
            font-size: 0.95rem;
            line-height: 1.5;
            margin-bottom: 15px;
        }
        
        .report-actions {
            display: flex;
            gap: 10px;
        }
        
        .btn {
            padding: 8px 16px;
            border: none;
            border-radius: 8px;
            font-size: 0.9rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 5px;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
        }
        
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }
        
        .btn-secondary {
            background: rgba(108, 117, 125, 0.1);
            color: #6c757d;
            border: 1px solid #dee2e6;
        }
        
        .btn-secondary:hover {
            background: #6c757d;
            color: white;
        }
        
        /* ğŸ”§ åŠŸèƒ½åŒºåŸŸ */
        .features-section {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 30px;
        }
        
        .features-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
        }
        
        .feature-item {
            text-align: center;
            padding: 20px;
            border-radius: 15px;
            background: rgba(102, 126, 234, 0.05);
            transition: all 0.3s ease;
        }
        
        .feature-item:hover {
            background: rgba(102, 126, 234, 0.1);
            transform: translateY(-3px);
        }
        
        .feature-icon {
            font-size: 2rem;
            color: #667eea;
            margin-bottom: 15px;
        }
        
        .feature-title {
            font-weight: 600;
            color: #2c3e50;
            margin-bottom: 8px;
        }
        
        .feature-desc {
            font-size: 0.9rem;
            color: #666;
        }
        
        /* ğŸ–¼ï¸ é¢„è§ˆåŒºåŸŸ */
        .preview-section {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 20px;
            margin-bottom: 30px;
        }

        .viewer-frame {
            width: 100%;
            height: 70vh;
            border: 1px solid #e9ecef;
            border-radius: 12px;
            background: #fff;
        }

        .toolbar {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 10px;
        }

        .btn-ghost {
            background: transparent;
            color: #667eea;
            border: 1px solid #dfe3f0;
        }

        .btn-ghost:hover {
            background: #eef1ff;
        }

        .active-card {
            border-color: #764ba2 !important;
        }

        /* ğŸ“± å“åº”å¼è®¾è®¡ */
        @media (max-width: 768px) {
            .main-title {
                font-size: 2rem;
            }
            
            .container {
                padding: 20px;
                margin: 10px;
            }
            
            .stats-grid {
                grid-template-columns: 1fr;
            }
            
            .reports-grid {
                grid-template-columns: 1fr;
            }
        }
        
        /* âœ¨ åŠ¨ç”»æ•ˆæœ */
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }
        
        .live-indicator {
            animation: pulse 2s infinite;
            color: #28a745;
        }

        /* ===== ç®€æ´é£æ ¼è¦†ç›–ï¼ˆMinimalï¼‰ ===== */
        body { background: #fff; color: #222; }
        .container { background: #fff; border: 1px solid #eee; backdrop-filter: none; box-shadow: none; }
        .main-title { color: #222; text-shadow: none; }
        .subtitle { color: #666; }
        .section-title i { color: inherit; }
        .reports-grid { display: none; }
        .preview-section { display: none; }
        .btn, .btn-primary, .btn-secondary { background: transparent; color: #333; border: 1px solid #ddd; box-shadow: none; }
        .btn-primary:hover, .btn-secondary:hover { background: #f7f7f7; color: #111; }
        .stats-grid, .features-section { display: none; }
        .simple-list { list-style: none; padding-left: 0; }
        .simple-list li { 
            border: 1px solid #eee; border-radius: 10px; padding: 12px 14px; margin-bottom: 10px; 
            display: flex; align-items: center; justify-content: space-between; gap: 12px; background: #fff; transition: box-shadow .2s ease, border-color .2s ease; 
        }
        .simple-list li:hover { box-shadow: 0 4px 14px rgba(0,0,0,.06); border-color: #e5e7eb; }
        .item-title { font-weight: 600; color: #222; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
        .item-right { display: flex; align-items: center; gap: 10px; }
        .item-open { color: #0b61c9; text-decoration: none; border: 1px solid #dfe3f0; padding: 6px 10px; border-radius: 6px; font-size: 12px; }
        .item-open:hover { background: #eef1ff; }
        .item-arrow { color: #c0c4cc; }

        /* ä¸Šè¯æŒ‡æ•°æ¡ */
        .sse-bar { margin: 10px 0 16px; padding: 10px 12px; border: 1px solid #eee; border-radius: 8px; background: #fafafa; transition: background-color .3s ease; }
        .sse-row { display: flex; align-items: baseline; gap: 10px; }
        .sse-name { font-weight: 700; }
        .sse-price { font-size: 18px; font-weight: 700; }
        .sse-pct { font-size: 14px; }
        .sse-time { margin-left: auto; font-size: 12px; color: #888; }

        .sse-up { background: #ffecec; }
        .sse-down { background: #e6ffed; }
        .sse-flat { background: #f6f6f6; }

        /* é£é™©æç¤º */
        .risk-footer { margin-top: 24px; padding-top: 12px; border-top: 1px solid #efefef; font-size: 12px; color: #666; }
        
        /* ğŸŒ™ æš—è‰²æ¨¡å¼æ”¯æŒ */
        @media (prefers-color-scheme: dark) {
            .report-card {
                background: linear-gradient(135deg, #2c3e50, #34495e);
                color: #ecf0f1;
            }
            
            .report-date {
                color: #ecf0f1;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- ğŸ¯ ä¸»æ ‡é¢˜åŒºåŸŸ -->
        <h1 class="main-title">
            <i class="fas fa-chart-line"></i>
            Aè‚¡ç‰›ç†Šé£å‘æ ‡é¢„æµ‹ç³»ç»Ÿ
        </h1>
        
        <!-- å®æ—¶ä¸Šè¯æŒ‡æ•°ï¼ˆå…è´¹æ¥å£ï¼‰ -->
        <!-- <div class="sse-bar sse-flat" id="sse-bar">
            <div class="sse-row">
                <span class="sse-name">ä¸Šè¯æŒ‡æ•°</span>
                <span class="sse-price" id="sse-price">--</span>
                <span class="sse-pct" id="sse-pct">--</span>
                <span class="sse-time" id="sse-time">--:--:--</span>
            </div>
        </div> -->

        <!-- ğŸ“Š ç»Ÿè®¡æ¦‚è§ˆ -->
        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-icon">
                    <i class="fas fa-chart-pie"></i>
                </div>
                <div class="stat-number" id="total-reports">2</div>
                <div class="stat-label">é¢„æµ‹æŠ¥å‘Šæ€»æ•°</div>
            </div>
            <div class="stat-card">
                <div class="stat-icon">
                    <i class="fas fa-calendar-check"></i>
                </div>
                <div class="stat-number" id="accuracy-rate">85%</div>
                <div class="stat-label">é¢„æµ‹å‡†ç¡®ç‡</div>
            </div>
            <div class="stat-card">
                <div class="stat-icon">
                    <i class="fas fa-clock"></i>
                </div>
                <div class="stat-number" id="last-update">ä»Šæ—¥</div>
                <div class="stat-label">æœ€åæ›´æ–°</div>
            </div>
            <div class="stat-card">
                <div class="stat-icon">
                    <i class="fas fa-trending-up"></i>
                </div>
                <div class="stat-number" id="market-trend">éœ‡è¡</div>
                <div class="stat-label">å½“å‰è¶‹åŠ¿</div>
            </div>
        </div>
        
        <!-- ğŸ“‹ é¢„æµ‹æŠ¥å‘Šåˆ—è¡¨ -->
        <div class="reports-section">
            <h2 class="section-title">
                <i class="fas fa-file-chart"></i>
                é¢„æµ‹æŠ¥å‘Šåˆ—è¡¨
            </h2>
            <div class="reports-grid" id="reports-container">
                <!-- æŠ¥å‘Šå¡ç‰‡å°†é€šè¿‡JavaScriptåŠ¨æ€ç”Ÿæˆ -->
            </div>
            <ul class="simple-list" id="simple-list"></ul>
            <div class="risk-footer">é£é™©æç¤ºï¼šæœ¬é¢„æµ‹ä¸ºé‡åŒ–ä¸è§„åˆ™èåˆçš„å‚è€ƒï¼Œä¸æ„æˆæŠ•èµ„å»ºè®®ã€‚è¯·ç»“åˆè‡ªèº«é£é™©æ‰¿å—èƒ½åŠ›å†³ç­–ã€‚</div>
        </div>

        <!-- ğŸ–¼ï¸ é¢„æµ‹é¢„è§ˆï¼ˆè‡ªåŠ¨è½®æ’­ï¼‰ -->
        <div class="preview-section">
            <div class="toolbar">
                <h2 class="section-title" style="margin:0;">
                    <i class="fas fa-eye"></i>
                    å®æ—¶é¢„è§ˆï¼ˆè‡ªåŠ¨è½®æ’­ï¼‰
                </h2>
                <div>
                    <button class="btn btn-ghost" id="prev-btn"><i class="fas fa-arrow-left"></i> ä¸Šä¸€ä»½</button>
                    <button class="btn btn-ghost" id="next-btn">ä¸‹ä¸€ä»½ <i class="fas fa-arrow-right"></i></button>
                </div>
            </div>
            <iframe id="report-viewer" class="viewer-frame" src=""></iframe>
            <div class="tips" style="margin-top:8px;color:#6c757d;font-size:12px;">æç¤ºï¼šå°†è‡ªåŠ¨ä»æœ¬ç›®å½•ä¸­å‘ç°å¹¶è½®æ’­è¿‘30å¤©çš„é¢„æµ‹æŠ¥å‘Šï¼Œäº¦å¯ç‚¹å‡»ä¸Šæ–¹å¡ç‰‡åˆ‡æ¢ã€‚</div>
        </div>
        
        <!-- ğŸ”§ ç³»ç»ŸåŠŸèƒ½ -->
        <div class="features-section">
            <h2 class="section-title">
                <i class="fas fa-cogs"></i>
                ç³»ç»ŸåŠŸèƒ½ç‰¹è‰²
            </h2>
            <div class="features-grid">
                <div class="feature-item">
                    <div class="feature-icon">
                        <i class="fas fa-brain"></i>
                    </div>
                    <div class="feature-title">AIæ™ºèƒ½åˆ†æ</div>
                    <div class="feature-desc">åŸºäºæ·±åº¦å­¦ä¹ ç®—æ³•ï¼Œå¤šç»´åº¦æ•°æ®åˆ†æ</div>
                </div>
                <div class="feature-item">
                    <div class="feature-icon">
                        <i class="fas fa-chart-line"></i>
                    </div>
                    <div class="feature-title">æŠ€æœ¯æŒ‡æ ‡</div>
                    <div class="feature-desc">MACDã€RSIã€KDJç­‰ä¸“ä¸šæŠ€æœ¯åˆ†æ</div>
                </div>
                <div class="feature-item">
                    <div class="feature-icon">
                        <i class="fas fa-shield-alt"></i>
                    </div>
                    <div class="feature-title">é£é™©æ§åˆ¶</div>
                    <div class="feature-desc">æ™ºèƒ½æ­¢æŸå»ºè®®ï¼Œä»“ä½ç®¡ç†ç­–ç•¥</div>
                </div>
                <div class="feature-item">
                    <div class="feature-icon">
                        <i class="fas fa-clock"></i>
                    </div>
                    <div class="feature-title">å®æ—¶æ›´æ–°</div>
                    <div class="feature-desc">æ¯æ—¥æ”¶ç›˜åè‡ªåŠ¨ç”Ÿæˆæ¬¡æ—¥é¢„æµ‹</div>
                </div>
            </div>
        </div>
    </div>
    
    <script>
        // ğŸ“Š åŠ¨æ€ç”ŸæˆæŠ¥å‘Šåˆ—è¡¨
        function stripSuffix(name) {
            return name.replace(/\.html?$/i, '');
        }

        function prettyTitleFromFilename(filename) {
            // ä¾‹ï¼šç‰›ç†Šé£å‘æ ‡æ˜æ—¥é¢„æµ‹_2025-09-15.html -> ç‰›ç†Šé£å‘æ ‡æ˜æ—¥é¢„æµ‹ï¼ˆ2025-09-15ï¼‰
            const base = filename.split('/').pop();
            const noExt = stripSuffix(base);
            const m = noExt.match(/^(.*)_(\d{4}-\d{2}-\d{2})$/);
            if (m) return `${m[1]}ï¼ˆ${m[2]}ï¼‰`;
            return noExt;
        }

        function generateReportsList(reports) {
            const ul = document.getElementById('simple-list');
            ul.innerHTML = reports.map(r => {
                const title = prettyTitleFromFilename(r.filename);
                return `
                <li>
                    <span class="item-title">${title}</span>
                    <span class="item-right">
                        <a class="item-open" href="${r.filename}" target="_blank">æ‰“å¼€</a>
                        <span class="item-arrow">â€º</span>
                    </span>
                </li>`;
            }).join('');
        }
        
        // ğŸ”— æ‰“å¼€æŠ¥å‘Š
        function openReport(filename) {
            window.open(filename, '_blank');
        }
        
        // ğŸ“¤ åˆ†äº«æŠ¥å‘Š
        function shareReport(filename) {
            const url = window.location.origin + window.location.pathname.replace('index.html', '') + filename;
            if (navigator.share) {
                navigator.share({
                    title: 'Aè‚¡ç‰›ç†Šé£å‘æ ‡é¢„æµ‹æŠ¥å‘Š',
                    text: 'æŸ¥çœ‹æœ€æ–°çš„Aè‚¡å¸‚åœºé¢„æµ‹åˆ†æ',
                    url: url
                });
            } else {
                navigator.clipboard.writeText(url).then(() => {
                    alert('æŠ¥å‘Šé“¾æ¥å·²å¤åˆ¶åˆ°å‰ªè´´æ¿ï¼');
                });
            }
        }
        
        // ğŸ“ˆ ä¸Šè¯æŒ‡æ•°ï¼ˆSina JSONPå…è´¹æ¥å£ï¼‰
        function fetchSSE() {
            return new Promise(resolve => {
                const cb = 'cb_' + Math.random().toString(36).slice(2);
                const script = document.createElement('script');
                window[cb] = function(res) {
                    try {
                        // å…¼å®¹ä¸¤ç§è¿”å›ï¼š1) var hq_str_sh000001="..." 2) JSONPç»“æ„
                        // æ–¹æ¡ˆ1ï¼šSinaå¸¸è§jsonpï¼šlist=sh000001
                        // ä½¿ç”¨ç®€åŒ–æ¥å£ï¼šhttp://hq.sinajs.cn/list=sh000001 ï¼ˆæ— JSONPå›è°ƒï¼Œä½¿ç”¨scriptä¼šæ³¨å…¥å…¨å±€å˜é‡ï¼‰
                        resolve(res);
                    } finally {
                        delete window[cb];
                        script.remove();
                    }
                };
                // é¦–é€‰ç›´æ¥å˜é‡æ¥å£
                const url = 'https://hq.sinajs.cn/list=sh000001';
                script.src = url;
                script.onerror = () => {
                    resolve(null);
                    script.remove();
                };
                document.body.appendChild(script);
                // å›é€€ï¼š2ç§’åå°è¯•ä»å…¨å±€å˜é‡è¯»å–
                setTimeout(() => {
                    try {
                        // hq_str_sh000001 æ ¼å¼: "ä¸Šè¯æŒ‡æ•°,æœ€æ–°,æ˜¨æ”¶,å¼€ç›˜,æˆäº¤é‡(æ‰‹),æˆäº¤é¢(ä¸‡),... ,æ—¥æœŸ,æ—¶é—´"
                        // å®æµ‹æ ¼å¼: name,now,close,open,volume,amount,high,low,ä¹°ç›˜,å–ç›˜,æˆäº¤é‡,æ—¥æœŸ,æ—¶é—´ ... ï¼ˆä¼šæœ‰å˜åŠ¨ï¼‰
                        let raw = window.hq_str_sh000001;
                        if (raw && typeof raw === 'string' && raw.length > 0) {
                            const parts = raw.split(',');
                            const name = parts[0];
                            const now = parseFloat(parts[1]);
                            const close = parseFloat(parts[2]);
                            const time = parts[parts.length - 1] || '';
                            resolve({ name, now, close, time });
                        }
                    } catch(e) { resolve(null); }
                }, 2000);
            });
        }

        function renderSSE(data) {
            const bar = document.getElementById('sse-bar');
            const priceEl = document.getElementById('sse-price');
            const pctEl = document.getElementById('sse-pct');
            const timeEl = document.getElementById('sse-time');
            if (!bar || !priceEl || !pctEl || !timeEl) return;
            if (!data || !isFinite(data.now) || !isFinite(data.close)) return;

            const pct = ((data.now - data.close) / data.close) * 100;
            priceEl.textContent = data.now.toFixed(2);
            pctEl.textContent = (pct >= 0 ? '+' : '') + pct.toFixed(2) + '%';
            timeEl.textContent = data.time || '';

            bar.classList.remove('sse-up','sse-down','sse-flat');
            if (pct > 0.01) bar.classList.add('sse-up');
            else if (pct < -0.01) bar.classList.add('sse-down');
            else bar.classList.add('sse-flat');
        }

        async function refreshSSE() {
            const data = await fetchSSE();
            renderSSE(data);
        }

        // ğŸ§­ è‡ªåŠ¨å‘ç°æœ¬ç›®å½•å†…çš„é¢„æµ‹æŠ¥å‘Šï¼ˆæŒ‰å‘½åè§„åˆ™å°è¯•ï¼‰
        async function discoverReports() {
            // ä»…æŒ‰è¿‘30å¤©å‘½åè§„åˆ™æ¢æµ‹ï¼Œæ¢æµ‹ä¸åˆ°åˆ™è¿”å›ç©ºåˆ—è¡¨ï¼ˆä¸ä½¿ç”¨é»˜è®¤åˆ—è¡¨ï¼‰
            const today = new Date();
            const ONE_DAY = 24 * 60 * 60 * 1000;
            const candidates = [];
            // å‘åå›æº¯60å¤©ï¼Œå‘å‰é¢„åˆ¤7å¤©ï¼ˆè¦†ç›–è·¨å‘¨/èŠ‚å‡æ—¥ç”Ÿæˆçš„T+1æ–‡ä»¶ï¼‰
            for (let i = 0; i <= 60; i++) {
                const d = new Date(today.getTime() - i * ONE_DAY);
                const y = d.getFullYear();
                const m = String(d.getMonth() + 1).padStart(2, '0');
                const day = String(d.getDate()).padStart(2, '0');
                candidates.push(`ç‰›ç†Šé£å‘æ ‡æ˜æ—¥é¢„æµ‹_${y}-${m}-${day}.html`);
            }
            for (let i = 1; i <= 7; i++) {
                const d = new Date(today.getTime() + i * ONE_DAY);
                const y = d.getFullYear();
                const m = String(d.getMonth() + 1).padStart(2, '0');
                const day = String(d.getDate()).padStart(2, '0');
                candidates.push(`ç‰›ç†Šé£å‘æ ‡æ˜æ—¥é¢„æµ‹_${y}-${m}-${day}.html`);
            }

            async function exists(path) {
                try {
                    const res = await fetch(path, { method: 'GET', cache: 'no-store' });
                    return res.ok;
                } catch (e) {
                    return false;
                }
            }

            const checks = await Promise.all(candidates.map(async f => ({ f, ok: await exists(f) })));
            const files = checks.filter(x => x.ok).map(x => x.f);

            const toObj = (fname) => {
                const m = fname.match(/(\d{4}-\d{2}-\d{2})/);
                return { filename: fname, date: m ? m[1] : fname, preview: '' };
            };
            return files.map(toObj).sort((a, b) => b.date.localeCompare(a.date));
        }

        // ğŸï¸ è‡ªåŠ¨è½®æ’­
        let carouselTimer = null;
        let currentIndex = 0;
        let reportList = [];

        function showReport(index) {
            if (!reportList.length) return;
            currentIndex = (index + reportList.length) % reportList.length;
            const viewer = document.getElementById('report-viewer');
            if (viewer) {
                viewer.src = reportList[currentIndex].filename;
                document.querySelectorAll('.report-card').forEach((el, i) => {
                    el.classList.toggle('active-card', i === currentIndex);
                });
            }
        }

        function startCarousel() {
            stopCarousel();
            carouselTimer = setInterval(() => {
                showReport(currentIndex + 1);
            }, 20000); // 20ç§’åˆ‡æ¢ä¸€æ¬¡
        }

        function stopCarousel() {
            if (carouselTimer) {
                clearInterval(carouselTimer);
                carouselTimer = null;
            }
        }

        function selectReport(index) {
            showReport(index);
            startCarousel();
        }

        // ğŸ”„ æ›´æ–°ç»Ÿè®¡æ•°æ®
        function updateStats() {
            const now = new Date();
            document.getElementById('last-update').textContent = 
                now.toLocaleDateString('zh-CN', { month: 'long', day: 'numeric' });
        }
        
        // ğŸ¯ è‡ªåŠ¨æ£€æµ‹æ–°æŠ¥å‘Š
        function checkForNewReports() {
            // è¿™é‡Œå¯ä»¥æ·»åŠ è‡ªåŠ¨æ£€æµ‹æ–°æŠ¥å‘Šçš„é€»è¾‘
            console.log('æ£€æŸ¥æ–°æŠ¥å‘Š...');
        }
        
        // ğŸš€ åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', async function() {
            // å‘ç°æŠ¥å‘Šå¹¶æ¸²æŸ“
            reportList = await discoverReports();
            generateReportsList(reportList);
            updateStats();
            // åˆ·æ–°ä¸Šè¯æŒ‡æ•°
            refreshSSE();
            setInterval(refreshSSE, 60 * 1000);

            // é¢„è§ˆé¦–ä¸ªå¹¶å¯åŠ¨è½®æ’­ï¼ˆä»…å½“æœ‰é¢„è§ˆæ¡†å­˜åœ¨æ—¶ï¼‰
            const viewer = document.getElementById('report-viewer');
            if (viewer && reportList.length) {
                showReport(0);
                startCarousel();
            }
            const totalEl = document.getElementById('total-reports');
            if (totalEl) totalEl.textContent = String(reportList.length);

            // ä¸Š/ä¸‹ä¸€ä»½
            const prevBtn = document.getElementById('prev-btn');
            const nextBtn = document.getElementById('next-btn');
            if (prevBtn && nextBtn) {
                prevBtn.addEventListener('click', () => {
                    stopCarousel();
                    showReport(currentIndex - 1);
                    startCarousel();
                });
                nextBtn.addEventListener('click', () => {
                    stopCarousel();
                    showReport(currentIndex + 1);
                    startCarousel();
                });
            }

            // æ¯5åˆ†é’Ÿæ£€æŸ¥ä¸€æ¬¡æ–°æŠ¥å‘Šï¼ˆå¯æ‰©å±•ï¼‰
            setInterval(checkForNewReports, 5 * 60 * 1000);
        });
        
        // ğŸ“± å“åº”å¼èœå•ï¼ˆå¦‚æœéœ€è¦ï¼‰
        function toggleMobileMenu() {
            // ç§»åŠ¨ç«¯èœå•åˆ‡æ¢é€»è¾‘
        }
    </script>
</body>
</html>